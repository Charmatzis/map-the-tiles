!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;"undefined"!=typeof window?i=window:"undefined"!=typeof global?i=global:"undefined"!=typeof self&&(i=self),i.MapTheTiles=t()}}(function(){return function t(i,e,n){function r(s,h){if(!e[s]){if(!i[s]){var m="function"==typeof require&&require;if(!h&&m)return m(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var p=e[s]={exports:{}};i[s][0].call(p.exports,function(t){var e=i[s][1][t];return r(e?e:t)},p,p.exports,t,i,e,n)}return e[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,i,e){function n(t){var i=t.map(function(t){return t[0]}),e=t.map(function(t){return t[1]});return{left:Math.min.apply(this,i),right:Math.max.apply(this,i),bottom:Math.max.apply(this,e),top:Math.min.apply(this,e)}}var r=t("transformatrix"),o=t("rectangles-intersect"),s=function(t,i,e){this.vpSize=t||{width:256,height:256},this.projExtent=i||{left:-20037508.342789244,right:20037508.342789244,bottom:-20037508.342789244,top:20037508.342789244},this.tSize=e||256,this.maxRes=Math.min(Math.abs(this.projExtent.right-this.projExtent.left)/this.tSize,Math.abs(this.projExtent.top-this.projExtent.bottom)/this.tSize)};s.prototype.getTiles=function(t,i,e){var s,h,m,a,p,f,u,c,l=this._getExtentPx(t,i),x=this._pointToPx(t,i),v=l,y=[];e&&0!=e&&(e=-e,s=new r,s.translate(x.x,x.y),s.rotate(Math.PI/180*e),s.translate(-x.x,-x.y),h=[s.transformPoint(l.left,l.bottom),s.transformPoint(l.right,l.bottom),s.transformPoint(l.right,l.top),s.transformPoint(l.left,l.top)],v=n(h)),m=Math.floor(v.left/this.tSize),a=Math.floor(v.right/this.tSize),p=Math.floor(v.bottom/this.tSize),f=Math.floor(v.top/this.tSize),u=topStart=Math.round(f*this.tSize-l.top),c=Math.round(m*this.tSize-l.left);for(var d=m;a>=d;d++){u=topStart;for(var M=f;p>=M;M++)y.push({x:d,y:M,z:i,top:u,left:c}),u+=this.tSize;c+=this.tSize}return e&&0!=e&&(y=y.filter(function(t){return o(h,this._getTileBoundingRect(t))},this)),y},s.prototype._getExtentPx=function(t,i){var e=this.maxRes/Math.pow(2,i);return{left:(t.x-this.projExtent.left)/e-this.vpSize.width/2,right:(t.x-this.projExtent.left)/e+this.vpSize.width/2,bottom:(this.projExtent.top-t.y)/e+this.vpSize.height/2,top:(this.projExtent.top-t.y)/e-this.vpSize.height/2}},s.prototype._pointToPx=function(t,i){var e=this.maxRes/Math.pow(2,i);return{x:(t.x-this.projExtent.left)/e,y:(this.projExtent.top-t.y)/e}},s.prototype._getTileBoundingRect=function(t){var i,e,n,t,r;return i=this.maxRes/Math.pow(2,t.z),e=t.x*this.tSize,n=e+this.tSize,t=t.y*this.tSize,r=t+this.tSize,[[e,r],[n,r],[n,t],[e,t]]},i.exports=s},{"rectangles-intersect":4,transformatrix:5}],2:[function(t,i,e){function n(t,i,e){var n=e||6,o=.5*Math.abs((i[0][1]-i[2][1])*(i[3][0]-i[1][0])+(i[1][1]-i[3][1])*(i[0][0]-i[2][0])),s=i.reduce(function(i,e,n,r){var o=n==r.length-1?0:n+1;return i+.5*Math.abs(t[0]*(r[n][1]-r[o][1])+r[n][0]*(r[o][1]-t[1])+r[o][0]*(t[1]-r[n][1]))},0);return r(s,n)==r(o,n)}function r(t,i){return parseInt(t*Math.pow(10,i))}i.exports=n},{}],3:[function(t,i,e){function n(t,i,e){var n,s,h=t[0][0],m=t[0][1],a=t[1][0],p=t[1][1],f=i[0][0],u=i[0][1],c=i[1][0],l=i[1][1],x=!1,v=e||6,y=(h-a)*(u-l)-(m-p)*(f-c);return 0==y?o((u-m)*(a-h),v)==o((p-m)*(f-h),v)&&(x=r(f,u,h,m,a,p,v)||r(c,l,h,m,a,p,v)):(n=((h*p-m*a)*(f-c)-(h-a)*(f*l-u*c))/y,s=((h*p-m*a)*(u-l)-(m-p)*(f*l-u*c))/y,x=r(n,s,h,m,a,p,v)&&r(n,s,f,u,c,l,v)),x}function r(t,i,e,n,r,s,h){return o(Math.min(e,r),h)<=o(t,h)&&o(t,h)<=o(Math.max(e,r),h)&&o(Math.min(n,s),h)<=o(i,h)&&o(i,h)<=o(Math.max(n,s),h)}function o(t,i){return parseInt(t*Math.pow(10,i))}i.exports=n},{}],4:[function(t,i,e){function n(t,i){var e=t.some(function(t,e,n){var o=e==n.length-1?0:e+1;return i.some(function(t,i,s){var h=i==s.length-1?0:i+1;return r([n[e],n[o]],[s[i],s[h]])})});return e||(e=i.some(function(i){return o(i,t)})||t.some(function(t){return o(t,i)})),e}var r=t("line-segments-intersect"),o=t("check-point-in-rectangle");i.exports=n},{"check-point-in-rectangle":2,"line-segments-intersect":3}],5:[function(t,i,e){var n=function(){this.reset()};n.prototype.reset=function(){return this.m=[1,0,0,1,0,0],this},n.prototype.multiply=function(t){var i=this.m[0]*t.m[0]+this.m[2]*t.m[1],e=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],o=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],s=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=i,this.m[1]=e,this.m[2]=n,this.m[3]=r,this.m[4]=o,this.m[5]=s,this},n.prototype.inverse=function(){var t=new n;t.m=this.m.slice(0);var i=1/(t.m[0]*t.m[3]-t.m[1]*t.m[2]),e=t.m[3]*i,r=-t.m[1]*i,o=-t.m[2]*i,s=t.m[0]*i,h=i*(t.m[2]*t.m[5]-t.m[3]*t.m[4]),m=i*(t.m[1]*t.m[4]-t.m[0]*t.m[5]);return t.m[0]=e,t.m[1]=r,t.m[2]=o,t.m[3]=s,t.m[4]=h,t.m[5]=m,t},n.prototype.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),n=this.m[0]*i+this.m[2]*e,r=this.m[1]*i+this.m[3]*e,o=this.m[0]*-e+this.m[2]*i,s=this.m[1]*-e+this.m[3]*i;return this.m[0]=n,this.m[1]=r,this.m[2]=o,this.m[3]=s,this},n.prototype.translate=function(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this},n.prototype.scale=function(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this},n.prototype.transformPoint=function(t,i){var e=t,n=i;return t=e*this.m[0]+n*this.m[2]+this.m[4],i=e*this.m[1]+n*this.m[3]+this.m[5],[t,i]},n.prototype.transformVector=function(t,i){var e=t,n=i;return t=e*this.m[0]+n*this.m[2],i=e*this.m[1]+n*this.m[3],[t,i]},"undefined"!=typeof i?i.exports=n:window.Matrix=n},{}]},{},[1])(1)});